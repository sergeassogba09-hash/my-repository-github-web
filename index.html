<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>GeoCapture</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
   <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon.png">
  <style>
    body { font-family:"Segoe UI",Arial,sans-serif; margin:0; padding:0; background:#f5f7fa; }
    header { background:#2c3e50; color:white; padding:15px; text-align:center; }
    nav { display:flex; gap:10px; margin:10px; }
    nav a { padding:8px 12px; background:#2c3e50; color:white; border-radius:4px; text-decoration:none; }
    nav a:hover { background:#34495e; }
    main { width:100%; max-width:900px; margin:auto; padding:15px; }
    #gallery { display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:12px; margin-top:20px; }
    .photo-card { display:flex; flex-direction:column; background:white; border:1px solid #ddd; border-radius:6px; padding:10px; }
    .photo-card img { width:100%; height:auto; object-fit:cover; border-radius:4px; margin-bottom:8px; }
    .photo-info { text-align:left; font-size:0.85em; margin-bottom:8px; }
    .delete-btn { background:#e74c3c; border:none; color:white; padding:6px 10px; border-radius:4px; cursor:pointer; }
    .delete-btn:hover { background:#c0392b; }
    #clearAll { background:#c0392b; color:white; border:none; border-radius:4px; padding:10px 15px; margin-bottom:15px; cursor:pointer; }
    #clearAll:hover { background:#a93226; }

    /* Bouton flottant vers la carte */
    #mapBtn {
      position:fixed;
      bottom:20px;
      right:20px;
      z-index:2000;
      background:#2c3e50;
      color:white;
      border:none;
      border-radius:50%;
      width:60px;
      height:60px;
      font-size:1.5em;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      text-decoration:none;
    }
    #mapBtn:hover { background:#34495e; }
  </style>
</head>
<body>
  <header>HOME</header>
  <main>
    <button id="clearAll">üóëÔ∏è Tout effacer</button>
    <div id="gallery"></div>
  </main>

  <!-- Bouton flottant vers la carte -->
  <a href="map.html" id="mapBtn">üó∫Ô∏è</a>

  <script>
    let savedData = JSON.parse(localStorage.getItem("captures")) || [];
    const gallery = document.getElementById("gallery");
    const clearAllBtn = document.getElementById("clearAll");

    function refreshGallery() {
      gallery.innerHTML = "";
      if (savedData.length === 0) {
        gallery.innerHTML = "<p>Aucune photo enregistr√©e.</p>";
        return;
      }
      savedData.forEach((d, index) => {
        const card = document.createElement("div");
        card.className = "photo-card";
        card.innerHTML = `
          <img src="${d.image}" alt="${d.name}">
          <div class="photo-info">
            <b>${d.name}</b><br>${d.date}<br>
            ${d.lat != null ? `[${d.lat.toFixed(4)}, ${d.lng.toFixed(4)}]` : "Coordonn√©es indisponibles"}
          </div>
          <button class="delete-btn" data-index="${index}">Supprimer</button>
        `;
        gallery.appendChild(card);
      });

      document.querySelectorAll(".delete-btn").forEach(btn => {
        btn.addEventListener("click", e => {
          const idx = Number(e.target.getAttribute("data-index"));
          savedData.splice(idx, 1);
          localStorage.setItem("captures", JSON.stringify(savedData));
          refreshGallery();
        });
      });
    }

    clearAllBtn.addEventListener("click", () => {
      if (confirm("Voulez-vous vraiment tout effacer ?")) {
        savedData = [];
        localStorage.removeItem("captures");
        refreshGallery();
      }
    });

    refreshGallery();
  </script>
  <script>
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      navigator.serviceWorker.register("/sw.js")
        .catch(console.error);
    });
  }
</script>
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#2c3e50">
</body>
</html>
